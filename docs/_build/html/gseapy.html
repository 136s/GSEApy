

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>gseapy package &mdash; gseapy 0.5.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="gseapy 0.5.0 documentation" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> gseapy
          

          
          </a>

          
            
            
              <div class="version">
                0.5.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Welcome to GSEAPY&#8217;s documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="run.html">How to Use GSEAPY</a></li>
<li class="toctree-l1"><a class="reference internal" href="gseapy_tutorial.html">A Protocol to walk through GSEAPY</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">gseapy</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>gseapy package</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/gseapy.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="gseapy-package">
<h1>gseapy package<a class="headerlink" href="#gseapy-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-gseapy.algorithm">
<span id="gseapy-algorithm-module"></span><h2>gseapy.algorithm module<a class="headerlink" href="#module-gseapy.algorithm" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="gseapy.algorithm.enrichment_score">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">enrichment_score</code><span class="sig-paren">(</span><em>gene_list</em>, <em>gene_set</em>, <em>weighted_score_type=1</em>, <em>correl_vector=None</em>, <em>esnull=False</em>, <em>rs=&lt;mtrand.RandomState object at 0x000001B6B7DF1900&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.algorithm.enrichment_score" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the most important function of GSEAPY. It has the same algorithm with GSEA.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gene_list</strong> &#8211; The ordered gene list gene_name_list, rank_metric[&#8216;gene_name&#8217;]</li>
<li><strong>gene_set</strong> &#8211; gene_sets in gmt file, please used gsea_gmt_parser to get gene_set.</li>
<li><strong>weighted_score_type</strong> &#8211; It&#8217;s indentical to gsea&#8217;s weighted_score method. weighting by the correlation 
is a very reasonable choice that allows significant gene sets with less than perfect coherence. 
options: 0(classic),1,1.5,2. default:1. if one is interested in penalizing sets for lack of 
coherence or to discover sets with any type of nonrandom distribution of tags, a value p &lt; 1 
might be appropriate. On the other hand, if one uses sets with largenumber of genes and only 
a small subset of those is expected to be coherent, then one could consider using p &gt; 1. 
Our recommendation is to use p = 1 and use other settings only if you are very experienced 
with the method and its behavior.</li>
<li><strong>correl_vector</strong> &#8211; A vector with the correlations (e.g. signal to noise scores) corresponding to the genes in 
the gene list. Or rankings, rank_metric[&#8216;rank&#8217;].values</li>
<li><strong>esnull</strong> &#8211; Only used this paramter when computing esnuall for statistial testing. set the esnull value
equal to the permutation number.</li>
<li><strong>rs</strong> &#8211; Random state for initialize gene list shuffling. Default: np.random.RandomState(seed=None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>ES: Enrichment score (real number between -1 and +1)</p>
<p>hit_index: index of a gene in gene_list, if gene included in gene_set.</p>
<p>RES: Numerical vector containing the running enrichment score for all locations in the gene list .</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.gsea_compute">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">gsea_compute</code><span class="sig-paren">(</span><em>data</em>, <em>gmt</em>, <em>n</em>, <em>weighted_score_type</em>, <em>permutation_type</em>, <em>method</em>, <em>phenoPos</em>, <em>phenoNeg</em>, <em>classes</em>, <em>ascending</em>, <em>seed</em>, <em>prerank=False</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.algorithm.gsea_compute" title="Permalink to this definition">¶</a></dt>
<dd><p>compute enrichment scores and enrichment nulls.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> &#8211; prepreocessed expression dataframe or a pre-ranked file if prerank=True.</li>
<li><strong>gmt</strong> &#8211; all gene sets in .gmt file. need to call gsea_gmt_parser() to get results.</li>
<li><strong>n</strong> &#8211; permutation number. default: 1000.</li>
<li><strong>method</strong> &#8211; ranking_metric method. see above.</li>
<li><strong>phenoPos</strong> &#8211; one of lables of phenotype&#8217;s names.</li>
<li><strong>phenoNeg</strong> &#8211; one of lable of phenotype&#8217;s names.</li>
<li><strong>classes</strong> &#8211; a list of phenotype labels, to specify which column of dataframe belongs to what catogry of phenotype.</li>
<li><strong>weighted_score_type</strong> &#8211; default:1</li>
<li><strong>ascending</strong> &#8211; sorting order of rankings. Default: False.</li>
<li><strong>seed</strong> &#8211; random seed. Default: np.random.RandomState()</li>
<li><strong>prerank</strong> &#8211; if true, this function will compute using pre-ranked file passed by parameter data.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>zipped results of es, nes, pval, fdr. Used for generating reportes and plotting.</p>
<p>a nested list of hit indexs of input gene_list. Used for plotting.</p>
<p>a nested list of ranked enrichment score of each input gene_sets. Used for plotting.</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.gsea_pval">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">gsea_pval</code><span class="sig-paren">(</span><em>es</em>, <em>esnull</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.algorithm.gsea_pval" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute nominal p-value.</p>
<p>From article (PNAS):
estimate nominal p-value for S from esnull by using the positive
or negative portion of the distribution corresponding to the sign 
of the observed ES(S).</p>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.gsea_significance">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">gsea_significance</code><span class="sig-paren">(</span><em>enrichment_scores</em>, <em>enrichment_nulls</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.algorithm.gsea_significance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute nominal p-vals, normalized ES, and FDR q value.</p>
<p>For a given NES(S) = NES* &gt;= 0. The FDR is the ratio of the percantage of all (S,pi) with
NES(S,pi) &gt;= 0, whose NES(S,pi) &gt;= NES*, divided by the percentage of
observed S wih NES(S) &gt;= 0, whose NES(S) &gt;= NES*, and similarly if NES(S) = NES* &lt;= 0.</p>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.normalize">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">normalize</code><span class="sig-paren">(</span><em>es</em>, <em>esnull</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.algorithm.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>normalize the ES(S,pi) and the observed ES(S), separetely rescaling
the positive and negative scores by divident by the mean of the ES(S,pi).</p>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.preprocess">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">preprocess</code><span class="sig-paren">(</span><em>df</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.algorithm.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>pre-processed the data frame.new filtering methods will be implement here.</p>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.ranking_metric">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">ranking_metric</code><span class="sig-paren">(</span><em>df</em>, <em>method</em>, <em>phenoPos</em>, <em>phenoNeg</em>, <em>classes</em>, <em>ascending</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.algorithm.ranking_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>The main function to rank an expression table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> &#8211; gene_expression DataFrame.</li>
<li><strong>method</strong> &#8211; <p>The method used to calculate a correlation or ranking. Default: &#8216;log2_ratio_of_classes&#8217;.
Others methods are:</p>
<ol class="arabic">
<li>&#8216;signal_to_noise&#8217;<p>You must have at least three samples for each phenotype to use this metric.
The larger the signal-to-noise ratio, the larger the differences of the means (scaled by the standard deviations);
that is, the more distinct the gene expression is in each phenotype and the more the gene acts as a “class marker.”</p>
</li>
<li>&#8216;t_test&#8217;<p>Uses the difference of means scaled by the standard deviation and number of samples. 
Note: You must have at least three samples for each phenotype to use this metric.
The larger the tTest ratio, the more distinct the gene expression is in each phenotype 
and the more the gene acts as a “class marker.”</p>
</li>
<li>&#8216;ratio_of_classes&#8217; (also referred to as fold change).<p>Uses the ratio of class means to calculate fold change for natural scale data.</p>
</li>
<li>&#8216;diff_of_classes&#8217;<p>Uses the difference of class means to calculate fold change for log scale data</p>
</li>
<li>&#8216;log2_ratio_of_classes&#8217;<p>Uses the log2 ratio of class means to calculate fold change for natural scale data.
This is the recommended statistic for calculating fold change for natural scale data.</p>
</li>
</ol>
</li>
<li><strong>phenoPos</strong> &#8211; one of lables of phenotype&#8217;s names.</li>
<li><strong>phenoNeg</strong> &#8211; one of lable of phenotype&#8217;s names.</li>
<li><strong>classes</strong> &#8211; a list of phenotype labels, to specify which column of dataframe belongs to what catogry of phenotype.</li>
<li><strong>ascending</strong> &#8211; bool or list of bool. Sort ascending vs. descending.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">returns correlation to class of each variable. same format with .rnk file. gene_name in first coloum,
correlation in second column.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.shuffle_list">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">shuffle_list</code><span class="sig-paren">(</span><em>gene_list</em>, <em>rand=&lt;mtrand.RandomState object at 0x000001B6B7DF1948&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.algorithm.shuffle_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of a shuffled input gene_list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gene_list</strong> &#8211; rank_metric[&#8216;gene_name&#8217;].values</li>
<li><strong>rand</strong> &#8211; random seed. Use random.Random(0) if you like.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a ranodm shuffled list.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-gseapy.enrichr">
<span id="gseapy-enrichr-module"></span><h2>gseapy.enrichr module<a class="headerlink" href="#module-gseapy.enrichr" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="gseapy.enrichr.enrichr">
<code class="descclassname">gseapy.enrichr.</code><code class="descname">enrichr</code><span class="sig-paren">(</span><em>gene_list</em>, <em>description</em>, <em>gene_set</em>, <em>outfile</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.enrichr.enrichr" title="Permalink to this definition">¶</a></dt>
<dd><p>Enrichr API.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>gene_list</strong> &#8211; flat file with list of genes, one gene id per row</li>
<li><strong>description</strong> &#8211; name of analysis</li>
<li><strong>enrich_library</strong> &#8211; Enrichr Library to query.</li>
<li><strong>outdir</strong> &#8211; out put file prefix</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.enrichr.get_libary_name">
<code class="descclassname">gseapy.enrichr.</code><code class="descname">get_libary_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.enrichr.get_libary_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-gseapy.gsea">
<span id="gseapy-gsea-module"></span><h2>gseapy.gsea module<a class="headerlink" href="#module-gseapy.gsea" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="gseapy.gsea.call">
<code class="descclassname">gseapy.gsea.</code><code class="descname">call</code><span class="sig-paren">(</span><em>data, gene_sets, cls, outdir='gseapy_out', min_size=15, max_size=1000, permutation_n=1000, weighted_score_type=1, permutation_type='gene_set', method='log2_ratio_of_classes', ascending=False, figsize=[6.5, 6], format='pdf', graph_num=20, seed=None</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.gsea.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Run Gene Set Enrichment Analysis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> &#8211; Gene expression data table.</li>
<li><strong>gene_sets</strong> &#8211; Gene sets file. e.g. gmt files. Same input with GSEA.</li>
<li><strong>permutation_n</strong> &#8211; Number of permutations for significance computation. Default: 1000.</li>
<li><strong>permutation_type</strong> &#8211; Permutation type, &#8220;phenotype&#8221; (default) for phenotypes, &#8220;gene_set&#8221; for genes.</li>
<li><strong>min_size</strong> (<em>int</em>) &#8211; Minimum allowed number of genes from gene set also the data set. Defaut: 15.</li>
<li><strong>max_size</strong> (<em>int</em>) &#8211; Maximum allowed number of genes from gene set also the data set. Defaults: 15 and 1000.</li>
<li><strong>weighted_score_type</strong> &#8211; refer to <code class="xref py py-func docutils literal"><span class="pre">algorithm.enrichment_socre()</span></code>. Default:1.</li>
<li><strong>method</strong> &#8211; ranking metric method, refer to <code class="xref py py-func docutils literal"><span class="pre">algorithm.ranking_metric()</span></code>.</li>
<li><strong>ascending</strong> &#8211; sorting order of rankings. Default: False.</li>
<li><strong>outdir</strong> &#8211; results output directory.</li>
<li><strong>figsize</strong> &#8211; matplotlib figsize, accept a tuple or list, e.g. [width,height]. Default: [6.5,6].</li>
<li><strong>format</strong> &#8211; matplotlib figure format. Default: pdf.</li>
<li><strong>graph_num</strong> &#8211; plot graphs for top sets of each phenotype</li>
<li><strong>seed</strong> &#8211; random seed. expect an interger. Defalut:None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>Generate <code class="docutils literal"><span class="pre">GSEA</span></code> plots and store a dictionary into csv file,
where dictionary key is a gene set and values are:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>| {es: enrichment score, 
|  nes: normalized enrichment score, 
|  p: P-value, 
|  fdr: FDR, 
|  size: gene set size,
|  matched_size: genes matched to the data, 
|  genes: gene names from the data set}
</pre></div>
</div>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.gsea.prerank">
<code class="descclassname">gseapy.gsea.</code><code class="descname">prerank</code><span class="sig-paren">(</span><em>rnk, gene_sets, outdir='gseapy_out', pheno_pos='Postive', pheno_neg='Negative', min_size=15, max_size=1000, permutation_n=1000, weighted_score_type=1, ascending=False, figsize=[6.5, 6], format='pdf', graph_num=20, seed=None</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.gsea.prerank" title="Permalink to this definition">¶</a></dt>
<dd><p>Run Gene Set Enrichment Analysis with pre-ranked correlation defined by user.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rnk</strong> &#8211; pre-ranked correlation table, Same input with <code class="docutils literal"><span class="pre">GSEA</span></code> .rnk file.</li>
<li><strong>gene_sets</strong> &#8211; Gene sets file. e.g. gmt files. Same input with GSEA.</li>
<li><strong>outdir</strong> &#8211; results output directory.</li>
<li><strong>permutation_n</strong> &#8211; Number of permutations for significance computation. Default: 1000.</li>
<li><strong>min_size</strong> (<em>int</em>) &#8211; Minimum allowed number of genes from gene set also the data set. Defaut: 15.</li>
<li><strong>max_size</strong> (<em>int</em>) &#8211; Maximum allowed number of genes from gene set also the data set. Defaults: 15 and 1000.</li>
<li><strong>weighted_score_type</strong> &#8211; refer to <code class="xref py py-func docutils literal"><span class="pre">algorithm.enrichment_socre()</span></code>. Default:1.</li>
<li><strong>ascending</strong> &#8211; sorting order of rankings. Default: False.</li>
<li><strong>figsize</strong> &#8211; matplotlib figsize, accept a tuple or list, e.g. [width,height]. Default: [6.5,6].</li>
<li><strong>format</strong> &#8211; matplotlib figure format. Default: pdf.</li>
<li><strong>graph_num</strong> &#8211; plot graphs for top sets of each phenotype</li>
<li><strong>seed</strong> &#8211; random seed. expect an interger. Defalut:None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>Generate <code class="docutils literal"><span class="pre">GSEA</span></code> plots and store a dictionary into csv file,
where dictionary key is a gene set and values are:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>| {es: enrichment score, 
|  nes: normalized enrichment score, 
|  p: P-value, 
|  fdr: FDR, 
|  size: gene set size,
|  matched_size: genes matched to the data, 
|  genes: gene names from the data set}
</pre></div>
</div>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.gsea.replot">
<code class="descclassname">gseapy.gsea.</code><code class="descname">replot</code><span class="sig-paren">(</span><em>indir, outdir='gseapy_out', weight=1, figsize=[6.5, 6], format='pdf', min_size=3, max_size=5000</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.gsea.replot" title="Permalink to this definition">¶</a></dt>
<dd><p>The main fuction to run inside python.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>indir</strong> &#8211; GSEA desktop results directory. In the sub folder, you must contain edb file foder.</li>
<li><strong>outdir</strong> &#8211; Output directory.</li>
<li><strong>weight</strong> &#8211; weighted score type. choose from {0,1,1.5,2}. Default: 1.</li>
<li><strong>figsize</strong> &#8211; matplotlib output figure figsize. Defult: [6.5,6].</li>
<li><strong>format</strong> &#8211; matplotlib output figure format. Default: &#8216;pdf&#8217;.</li>
<li><strong>min_size</strong> &#8211; min size of input genes presented in Gene Sets. Default: 3.</li>
<li><strong>max_size</strong> &#8211; max size of input genes presented in Gene Sets. Default: 5000.
you will not encourage to use min_size, or max_size argment in <a class="reference internal" href="#gseapy.gsea.replot" title="gseapy.gsea.replot"><code class="xref py py-func docutils literal"><span class="pre">replot()</span></code></a> function.
Because gmt file has already been filter.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Generate new figures with seleted figure format. Default: &#8216;pdf&#8217;.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-gseapy.gsea_plot">
<span id="gseapy-gsea-plot-module"></span><h2>gseapy.gsea_plot module<a class="headerlink" href="#module-gseapy.gsea_plot" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="gseapy.gsea_plot.gsea_plot">
<code class="descclassname">gseapy.gsea_plot.</code><code class="descname">gsea_plot</code><span class="sig-paren">(</span><em>rank_metric</em>, <em>enrich_term</em>, <em>hit_ind</em>, <em>nes</em>, <em>pval</em>, <em>fdr</em>, <em>RES</em>, <em>phenoPos=None</em>, <em>phenoNeg=None</em>, <em>figsize=(6.5</em>, <em>6)</em>, <em>**kwarg</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.gsea_plot.gsea_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the main function for reproducing the gsea plot.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rank_metric</strong> &#8211; rankings, rank_metric[&#8216;rank&#8217;].values.</li>
<li><strong>enrich_term</strong> &#8211; gene_set name</li>
<li><strong>hit_ind</strong> &#8211; hit indexs of rank_metric[&#8216;gene_name&#8217;] presented in gene set S.</li>
<li><strong>nes</strong> &#8211; Normalized enrichment scores.</li>
<li><strong>pval</strong> &#8211; nominal p-value.</li>
<li><strong>fdr</strong> &#8211; false discoveray rate.</li>
<li><strong>RES</strong> &#8211; ranking enrichment scores of all genes in rank_metric[&#8216;gene_name&#8217;].</li>
<li><strong>phenoPos</strong> &#8211; phenotype lable, positive correlated.</li>
<li><strong>phenoNeg</strong> &#8211; phenotype lable, negative correlated.</li>
<li><strong>figsize</strong> &#8211; matplotlib figsize.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">fig object of gsea plot.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-gseapy.parser">
<span id="gseapy-parser-module"></span><h2>gseapy.parser module<a class="headerlink" href="#module-gseapy.parser" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="gseapy.parser.gsea_cls_parser">
<code class="descclassname">gseapy.parser.</code><code class="descname">gsea_cls_parser</code><span class="sig-paren">(</span><em>cls</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.parser.gsea_cls_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Extact class(phenotype) name from .cls file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cls</strong> &#8211; the .cls file where located inside edb folder.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">phenotype name and a list of class vector.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.parser.gsea_edb_parser">
<code class="descclassname">gseapy.parser.</code><code class="descname">gsea_edb_parser</code><span class="sig-paren">(</span><em>results_path</em>, <em>index=0</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.parser.gsea_edb_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse results.edb file stored under <strong>edb</strong> file folder.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>results_path</strong> &#8211; the .results file where lcoated inside edb folder.</li>
<li><strong>index</strong> &#8211; gene_set index of gmt database, used for iterating items.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">enrichment_term, hit_index,nes, pval, fdr.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.parser.gsea_gmt_parser">
<code class="descclassname">gseapy.parser.</code><code class="descname">gsea_gmt_parser</code><span class="sig-paren">(</span><em>gmt</em>, <em>min_size=3</em>, <em>max_size=5000</em>, <em>gene_list=None</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.parser.gsea_gmt_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse gene_sets.gmt(gene set database) file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gmt</strong> &#8211; the gene_sets.gmt file where loacated inside edb folder.</li>
<li><strong>min_size</strong> &#8211; Minimum allowed number of genes from gene set also the data set. Default: 3.</li>
<li><strong>max_size</strong> &#8211; Maximum allowed number of genes from gene set also the data set. Default: 5000.</li>
<li><strong>gene_list</strong> &#8211; Used for filtering gene set. Only used this argument for <code class="xref py py-func docutils literal"><span class="pre">run()</span></code> method.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Return a new filtered gene set database dictionary.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>DO NOT</strong> filter gene sets, when use <code class="xref py py-func docutils literal"><span class="pre">replot()</span></code>. Because <code class="docutils literal"><span class="pre">GSEA</span></code> Desktop have already
do this for you.</p>
</dd></dl>

<dl class="function">
<dt id="gseapy.parser.gsea_rank_metric">
<code class="descclassname">gseapy.parser.</code><code class="descname">gsea_rank_metric</code><span class="sig-paren">(</span><em>rnk</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.parser.gsea_rank_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse .rnk file. This file contains ranking correlation vector and gene names or ids.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rnk</strong> &#8211; the .rnk file where located inside the edb folder.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a pandas DataFrame with 3 columns names are:<div class="highlight-python"><div class="highlight"><pre><span></span>&#39;gene_name&#39;,&#39;rank&#39;,rank2&#39;
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-gseapy">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-gseapy" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Zhuoqing Fang.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.5.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>