

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>How to Use GSEAPY &mdash; GSEApy 0.8.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="GSEApy 0.8.0 documentation" href="index.html"/>
        <link rel="next" title="A Protocol to Prepare files for GSEAPY" href="gseapy_tutorial.html"/>
        <link rel="prev" title="Welcome to GSEAPY’s documentation!" href="introduction.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> GSEApy
          

          
          </a>

          
            
            
              <div class="version">
                0.8.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Welcome to GSEAPY&#8217;s documentation!</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">How to Use GSEAPY</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#for-command-line-usage">For command line usage:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-gseapy-inside-python">Run gseapy inside python:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#to-see-help-information-of-gseapy">To See help information of GSEAPY</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gseapy-subcommands">1. gseapy subcommands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-subcommands-help">2. The subcommands help</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-apis">Module APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-gseapy.algorithm">Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-gseapy.enrichr">Enrichr</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-gseapy.parser">Parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-gseapy.plot">Graph</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gseapy_tutorial.html">A Protocol to Prepare files for GSEAPY</a></li>
<li class="toctree-l1"><a class="reference internal" href="gseapy_example.html">GSEAPY Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="gseapy_example.html#load-essential-packages">1. Load essential packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="gseapy_example.html#see-all-gseapy-supported-enrichr-library-names">See all gseapy supported enrichr library names</a></li>
<li class="toctree-l1"><a class="reference internal" href="gseapy_example.html#enrichr-example">2. Enrichr Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="gseapy_example.html#ii-commandline-usage">ii . Commandline usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="gseapy_example.html#prerank-example">3. Prerank example</a></li>
<li class="toctree-l1"><a class="reference internal" href="gseapy_example.html#id1">ii . Commandline usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="gseapy_example.html#call-example">4. Call Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="gseapy_example.html#id2">ii . Commandline usage</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GSEApy</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>How to Use GSEAPY</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/run.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-gseapy">
<span id="how-to-use-gseapy"></span><span id="run"></span><h1>How to Use GSEAPY<a class="headerlink" href="#module-gseapy" title="Permalink to this headline">¶</a></h1>
<div class="section" id="for-command-line-usage">
<h2>For command line usage:<a class="headerlink" href="#for-command-line-usage" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">enrichr</span></code> module will call enrichr-api. You need a gene_list file for input. That&#8217;s all.</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span># An example to use enrichr api
$ gseapy enrichr -i gene_list.txt -g KEGG_2016 -d pathway_enrichment -o test
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">replot</span></code> module reproduce GSEA desktop version results. The only input for replot module is the location to GSEA results.</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span># An example to reproduce figures using replot module.
$ gseapy replot -i ./gsea -o gseapy_out
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">call</span></code> module produce GSEAPY results.</p>
<p>The input requries a txt file( FPKM, Expected Counts, TPM, et.al), a cls file,
and gene_sets file in gmt format.</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span># an example to compute using gseapy call module
$ gseapy call -d gsea_data.txt -c test.cls -g gene_sets.gmt
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">prerank</span></code> module input expects a pre-ranked gene list dataset with correlation values, which in .rnk format,
and gene_sets file in gmt format.  <code class="docutils literal"><span class="pre">prerank</span></code> module is an API to <cite>GSEA</cite> pre-rank tools.</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span>$ gseapy prerank -r gsea_data.rnk -g gene_sets.gmt -o test
</pre></div>
</div>
<p>The input files&#8217; formats are identical to <code class="docutils literal"><span class="pre">GSEA</span></code> desktop version.
See <span class="xref std std-ref">example</span> for details, or, see <a class="reference external" href="http://www.broadinstitute.org/cancer/software/gsea/wiki/index.php/Main_Page">GSEA</a> documentation for more information.</p>
</div>
<div class="section" id="run-gseapy-inside-python">
<h2>Run gseapy inside python:<a class="headerlink" href="#run-gseapy-inside-python" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gseapy</span>
</pre></div>
</div>
<p>This will import the following:</p>
<ul class="simple">
<li>The <a class="reference internal" href="#module-gseapy.enrichr" title="gseapy.enrichr"><code class="xref py py-func docutils literal"><span class="pre">enrichr()</span></code></a> function to perform gene set enrichment analysis by calling enrichr online api.</li>
</ul>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># call enrichr</span>
<span class="n">gseapy</span><span class="o">.</span><span class="n">enrichr</span><span class="p">(</span><span class="n">gene_list</span><span class="o">=</span><span class="s1">&#39;gene_list.txt&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;pathway_analysis&#39;</span><span class="p">,</span> <span class="n">gene_set</span><span class="o">=</span><span class="s1">&#39;KEGG_2016&#39;</span><span class="p">,</span> <span class="n">outdir</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li>The <a class="reference internal" href="#gseapy.replot" title="gseapy.replot"><code class="xref py py-func docutils literal"><span class="pre">replot()</span></code></a> function to reproduce GSEA desktop results</li>
</ul>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># An example to reproduce figures using replot module.</span>
<span class="n">gseapy</span><span class="o">.</span><span class="n">replot</span><span class="p">(</span><span class="s1">&#39;gsea&#39;</span><span class="p">,</span><span class="s1">&#39;gseapy_out&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li>The <a class="reference internal" href="#gseapy.call" title="gseapy.call"><code class="xref py py-func docutils literal"><span class="pre">call()</span></code></a> function to computing es,nes,pval,fdr,and generate plots <em>de novo</em>.</li>
</ul>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># An example to calculate es, nes, pval,fdrs, and produce figures using gseapy.</span>
<span class="n">gseapy</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;gsea_dat.txt&#39;</span><span class="p">,</span> <span class="n">gene_sets</span><span class="o">=</span><span class="s1">&#39;gene_sets.gmt&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="s1">&#39;test.cls&#39;</span><span class="p">,</span> <span class="n">outdir</span><span class="o">=</span><span class="s1">&#39;gseapy_out&#39;</span><span class="p">,</span>
          <span class="n">min_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">max_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">permutation_n</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">weighted_score_type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
          <span class="n">permutation_type</span> <span class="o">=</span> <span class="s1">&#39;gene_set&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;log2_ratio_of_classes&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li>The <a class="reference internal" href="#gseapy.prerank" title="gseapy.prerank"><code class="xref py py-func docutils literal"><span class="pre">prerank()</span></code></a> function to computing es,nes,pval,fdr,and generate plots using a pre-ranked gene list.</li>
</ul>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># An example to calculate es, nes, pval,fdrs, and produce figures using gseapy.</span>
<span class="n">gseapy</span><span class="o">.</span><span class="n">prerank</span><span class="p">(</span><span class="n">rnk</span><span class="o">=</span><span class="s1">&#39;gsea_data.rnk&#39;</span><span class="p">,</span> <span class="n">gene_sets</span><span class="o">=</span><span class="s1">&#39;ene_sets.gmt&#39;</span><span class="p">,</span> <span class="n">outdir</span><span class="o">=</span><span class="s1">&#39;gseapy_out&#39;</span><span class="p">,</span> <span class="n">min_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
               <span class="n">max_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">permutation_n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">weighted_score_type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="to-see-help-information-of-gseapy">
<h2>To See help information of GSEAPY<a class="headerlink" href="#to-see-help-information-of-gseapy" title="Permalink to this headline">¶</a></h2>
<div class="section" id="gseapy-subcommands">
<h3>1. gseapy subcommands<a class="headerlink" href="#gseapy-subcommands" title="Permalink to this headline">¶</a></h3>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span>$ gseapy --help

 usage: gseapy [-h] [--version] {call,prerank,replot,enrichr} ...

 gseapy -- Gene Set Enrichment Analysis in Python

 positional arguments:
   {call,replot}
     call       Main GSEAPY Function: run GSEAPY instead of GSEA.
     prerank    Using pre-ranked tool to run GSEAPY.
     replot     Reproduce GSEA desktop figures.
     enrichr    Peform GSEA using enrichr API.
 optional arguments:
   -h, --help   show this help message and exit
   --version    show program&#39;s version number and exit
</pre></div>
</div>
<p>For command line options of each command, type: gseapy COMMAND -h</p>
</div>
<div class="section" id="the-subcommands-help">
<h3>2. The subcommands help<a class="headerlink" href="#the-subcommands-help" title="Permalink to this headline">¶</a></h3>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span>$ gseapy replot -h
# or
$ gseapy call -h
# or
$ gseapy prerank -h
# or
$ gseapy enrichr -h
</pre></div>
</div>
</div>
</div>
<div class="section" id="module-apis">
<h2>Module APIs<a class="headerlink" href="#module-apis" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="gseapy.replot">
<code class="descclassname">gseapy.</code><code class="descname">replot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.replot" title="Permalink to this definition">¶</a></dt>
<dd><p>The main fuction to run inside python.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>indir</strong> &#8211; GSEA desktop results directory. In the sub folder, you must contain edb file foder.</li>
<li><strong>outdir</strong> &#8211; Output directory.</li>
<li><strong>weight</strong> &#8211; weighted score type. choose from {0,1,1.5,2}. Default: 1.</li>
<li><strong>figsize</strong> &#8211; matplotlib output figure figsize. Defult: [6.5,6].</li>
<li><strong>format</strong> &#8211; matplotlib output figure format. Default: &#8216;pdf&#8217;.</li>
<li><strong>min_size</strong> &#8211; min size of input genes presented in Gene Sets. Default: 3.</li>
<li><strong>max_size</strong> &#8211; max size of input genes presented in Gene Sets. Default: 5000.
you will not encourage to use min_size, or max_size argment in <a class="reference internal" href="#gseapy.replot" title="gseapy.replot"><code class="xref py py-func docutils literal"><span class="pre">replot()</span></code></a> function.
Because gmt file has already been filter.</li>
<li><strong>verbose</strong> &#8211; Bool, increase output verbosity, print out progress of your job, Default: False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Generate new figures with seleted figure format. Default: &#8216;pdf&#8217;.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.call">
<code class="descclassname">gseapy.</code><code class="descname">call</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Run Gene Set Enrichment Analysis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> &#8211; Gene expression data table.</li>
<li><strong>gene_sets</strong> &#8211; Gene sets file. e.g. gmt files. Same input with GSEA.</li>
<li><strong>permutation_n</strong> &#8211; Number of permutations for significance computation. Default: 1000.</li>
<li><strong>permutation_type</strong> &#8211; Permutation type, &#8220;phenotype&#8221; for phenotypes, &#8220;gene_set&#8221; for genes.</li>
<li><strong>min_size</strong> (<em>int</em>) &#8211; Minimum allowed number of genes from gene set also the data set. Defaut: 15.</li>
<li><strong>max_size</strong> (<em>int</em>) &#8211; Maximum allowed number of genes from gene set also the data set. Defaults: 500.</li>
<li><strong>weighted_score_type</strong> &#8211; Refer to <code class="xref py py-func docutils literal"><span class="pre">algorithm.enrichment_socre()</span></code>. Default:1.</li>
<li><strong>method</strong> &#8211; <p>The method used to calculate a correlation or ranking. Default: &#8216;log2_ratio_of_classes&#8217;.
Others methods are:</p>
<ol class="arabic">
<li>&#8216;signal_to_noise&#8217;<p>You must have at least three samples for each phenotype to use this metric.
The larger the signal-to-noise ratio, the larger the differences of the means (scaled by the standard deviations);
that is, the more distinct the gene expression is in each phenotype and the more the gene acts as a “class marker.”</p>
</li>
<li>&#8216;t_test&#8217;<p>Uses the difference of means scaled by the standard deviation and number of samples. 
Note: You must have at least three samples for each phenotype to use this metric.
The larger the tTest ratio, the more distinct the gene expression is in each phenotype 
and the more the gene acts as a “class marker.”</p>
</li>
<li>&#8216;ratio_of_classes&#8217; (also referred to as fold change).<p>Uses the ratio of class means to calculate fold change for natural scale data.</p>
</li>
<li>&#8216;diff_of_classes&#8217;<p>Uses the difference of class means to calculate fold change for log scale data</p>
</li>
<li>&#8216;log2_ratio_of_classes&#8217;<p>Uses the log2 ratio of class means to calculate fold change for natural scale data.
This is the recommended statistic for calculating fold change for natural scale data.</p>
</li>
</ol>
</li>
<li><strong>ascending</strong> &#8211; Sorting order of rankings. Default: False.</li>
<li><strong>outdir</strong> &#8211; Results output directory.</li>
<li><strong>figsize</strong> &#8211; Matplotlib figsize, accept a tuple or list, e.g. [width,height]. Default: [6.5,6].</li>
<li><strong>format</strong> &#8211; Matplotlib figure format. Default: &#8216;pdf&#8217;.</li>
<li><strong>graph_num</strong> &#8211; Plot graphs for top sets of each phenotype</li>
<li><strong>seed</strong> &#8211; Random seed. expect an interger. Defalut:None.</li>
<li><strong>verbose</strong> &#8211; Bool, increase output verbosity, print out progress of your job, Default: False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>Return a DataFrame when inside python console.
Generate <code class="docutils literal"><span class="pre">GSEA</span></code> plots and store a dictionary into csv file,
where  each column represents:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="p">{</span><span class="n">es</span><span class="p">:</span> <span class="n">enrichment</span> <span class="n">score</span><span class="p">,</span> 
<span class="o">|</span>  <span class="n">nes</span><span class="p">:</span> <span class="n">normalized</span> <span class="n">enrichment</span> <span class="n">score</span><span class="p">,</span> 
<span class="o">|</span>  <span class="n">p</span><span class="p">:</span> <span class="n">P</span><span class="o">-</span><span class="n">value</span><span class="p">,</span> 
<span class="o">|</span>  <span class="n">fdr</span><span class="p">:</span> <span class="n">FDR</span><span class="p">,</span> 
<span class="o">|</span>  <span class="n">size</span><span class="p">:</span> <span class="n">gene</span> <span class="nb">set</span> <span class="n">size</span><span class="p">,</span>
<span class="o">|</span>  <span class="n">matched_size</span><span class="p">:</span> <span class="n">genes</span> <span class="n">matched</span> <span class="n">to</span> <span class="n">the</span> <span class="n">data</span><span class="p">,</span> 
<span class="o">|</span>  <span class="n">genes</span><span class="p">:</span> <span class="n">gene</span> <span class="n">names</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">data</span> <span class="nb">set</span><span class="p">}</span>
</pre></div>
</div>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.prerank">
<code class="descclassname">gseapy.</code><code class="descname">prerank</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.prerank" title="Permalink to this definition">¶</a></dt>
<dd><p>Run Gene Set Enrichment Analysis with pre-ranked correlation defined by user.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rnk</strong> &#8211; pre-ranked correlation table, Same input with <code class="docutils literal"><span class="pre">GSEA</span></code> .rnk file.</li>
<li><strong>gene_sets</strong> &#8211; Gene sets file. e.g. gmt files. Same input with GSEA.</li>
<li><strong>outdir</strong> &#8211; results output directory.</li>
<li><strong>permutation_n</strong> &#8211; Number of permutations for significance computation. Default: 1000.</li>
<li><strong>min_size</strong> (<em>int</em>) &#8211; Minimum allowed number of genes from gene set also the data set. Defaut: 15.</li>
<li><strong>max_size</strong> (<em>int</em>) &#8211; Maximum allowed number of genes from gene set also the data set. Defaults: 500.</li>
<li><strong>weighted_score_type</strong> &#8211; Refer to <code class="xref py py-func docutils literal"><span class="pre">algorithm.enrichment_socre()</span></code>. Default:1.</li>
<li><strong>ascending</strong> &#8211; Sorting order of rankings. Default: False.</li>
<li><strong>figsize</strong> &#8211; Matplotlib figsize, accept a tuple or list, e.g. [width,height]. Default: [6.5,6].</li>
<li><strong>format</strong> &#8211; Matplotlib figure format. Default: &#8216;pdf&#8217;.</li>
<li><strong>graph_num</strong> &#8211; Plot graphs for top sets of each phenotype</li>
<li><strong>seed</strong> &#8211; Random seed. expect an interger. Defalut:None.</li>
<li><strong>verbose</strong> &#8211; Bool, increase output verbosity, print out progress of your job, Default: False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>Return a DataFrame when inside python console.
Generate <code class="docutils literal"><span class="pre">GSEA</span></code> plots and store a dictionary into csv file,
where each column represents:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="p">{</span><span class="n">es</span><span class="p">:</span> <span class="n">enrichment</span> <span class="n">score</span><span class="p">,</span> 
<span class="o">|</span>  <span class="n">nes</span><span class="p">:</span> <span class="n">normalized</span> <span class="n">enrichment</span> <span class="n">score</span><span class="p">,</span> 
<span class="o">|</span>  <span class="n">p</span><span class="p">:</span> <span class="n">P</span><span class="o">-</span><span class="n">value</span><span class="p">,</span> 
<span class="o">|</span>  <span class="n">fdr</span><span class="p">:</span> <span class="n">FDR</span><span class="p">,</span> 
<span class="o">|</span>  <span class="n">size</span><span class="p">:</span> <span class="n">gene</span> <span class="nb">set</span> <span class="n">size</span><span class="p">,</span>
<span class="o">|</span>  <span class="n">matched_size</span><span class="p">:</span> <span class="n">genes</span> <span class="n">matched</span> <span class="n">to</span> <span class="n">the</span> <span class="n">data</span><span class="p">,</span> 
<span class="o">|</span>  <span class="n">genes</span><span class="p">:</span> <span class="n">gene</span> <span class="n">names</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">data</span> <span class="nb">set</span><span class="p">}</span>
</pre></div>
</div>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.enrichr">
<code class="descclassname">gseapy.</code><code class="descname">enrichr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.enrichr" title="Permalink to this definition">¶</a></dt>
<dd><p>Enrichr API.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gene_list</strong> &#8211; Flat file with list of genes, one gene id per row.
or a python list object</li>
<li><strong>gene_sets</strong> &#8211; Enrichr Library to query.</li>
<li><strong>description</strong> &#8211; name of analysis</li>
<li><strong>outdir</strong> &#8211; Output file directory</li>
<li><strong>cutoff</strong> &#8211; Adjust P-value cutoff, for plotting. Default: 0.05</li>
<li><strong>format</strong> &#8211; Output figure format supported by matplotlib,(&#8216;pdf&#8217;,&#8217;png&#8217;,&#8217;eps&#8217;...). Default: &#8216;pdf&#8217;.</li>
<li><strong>no_plot</strong> &#8211; Bool, if equal to True, no figure will be draw. This is useful only if data are interested. Default: False.</li>
<li><strong>verbose</strong> &#8211; Bool, increase output verbosity, print out progress of your job, Default: False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A DataFrame of enrchment results, only if call <code class="docutils literal"><span class="pre">enrichr</span></code> inside python console.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-gseapy.algorithm">
<span id="algorithm"></span><h2>Algorithm<a class="headerlink" href="#module-gseapy.algorithm" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="gseapy.algorithm.enrichment_score">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">enrichment_score</code><span class="sig-paren">(</span><em>gene_list</em>, <em>gene_set</em>, <em>weighted_score_type=1</em>, <em>correl_vector=None</em>, <em>esnull=None</em>, <em>rs=&lt;mtrand.RandomState object&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.algorithm.enrichment_score" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the most important function of GSEAPY. It has the same algorithm with GSEA.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gene_list</strong> &#8211; The ordered gene list gene_name_list, rank_metric[&#8216;gene_name&#8217;]</li>
<li><strong>gene_set</strong> &#8211; gene_sets in gmt file, please used gsea_gmt_parser to get gene_set.</li>
<li><strong>weighted_score_type</strong> &#8211; It&#8217;s indentical to gsea&#8217;s weighted_score method. weighting by the correlation 
is a very reasonable choice that allows significant gene sets with less than perfect coherence. 
options: 0(classic),1,1.5,2. default:1. if one is interested in penalizing sets for lack of 
coherence or to discover sets with any type of nonrandom distribution of tags, a value p &lt; 1 
might be appropriate. On the other hand, if one uses sets with largenumber of genes and only 
a small subset of those is expected to be coherent, then one could consider using p &gt; 1. 
Our recommendation is to use p = 1 and use other settings only if you are very experienced 
with the method and its behavior.</li>
<li><strong>correl_vector</strong> &#8211; A vector with the correlations (e.g. signal to noise scores) corresponding to the genes in 
the gene list. Or rankings, rank_metric[&#8216;rank&#8217;].values</li>
<li><strong>esnull</strong> &#8211; Only used this paramter when computing esnuall for statistial testing. set the esnull value
equal to the permutation number.</li>
<li><strong>rs</strong> &#8211; Random state for initialize gene list shuffling. Default: np.random.RandomState(seed=None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>ES: Enrichment score (real number between -1 and +1)</p>
<p>hit_index: index of a gene in gene_list, if gene included in gene_set.</p>
<p>RES: Numerical vector containing the running enrichment score for all locations in the gene list .</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.enrichment_score_ss">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">enrichment_score_ss</code><span class="sig-paren">(</span><em>gene_set</em>, <em>expressions</em>, <em>weighted_score_type=0.25</em>, <em>esnull=None</em>, <em>rs=&lt;mtrand.RandomState object&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.algorithm.enrichment_score_ss" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a gene set, a map of gene names to expression levels, and a weight score, returns the ssGSEA
enrichment score for the gene set as described by <em>D. Barbie et al 2009</em></p>
<p>ssGSEA  allows one to define an enrichment score that represents the degree of absolute enrichment
of a gene set in each sample within a given data set.  
The  enrichment score was produced using the Empirical Cumulative Distribution Functions (ECDF)
of the genes in the signature and the remaining genes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Requires:</th><td class="field-body"><p class="first">every member of gene_set is a key in expressions</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gene_set</strong> &#8211; a list of gene_names in the gene_set given by gmt file.</li>
<li><strong>expressions</strong> &#8211; dict, a dictionary mapping gene names to their absolute expression values</li>
<li><strong>weighted_score_type</strong> &#8211; the weighted exponent on the  term.</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">an array representing the intermediate Enrichment Scores for each step along the sorted gene list.
To find the total enrichment score, take the sum of all values in the array.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.gsea_compute">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">gsea_compute</code><span class="sig-paren">(</span><em>data</em>, <em>gmt</em>, <em>n</em>, <em>weighted_score_type</em>, <em>permutation_type</em>, <em>method</em>, <em>phenoPos</em>, <em>phenoNeg</em>, <em>classes</em>, <em>ascending</em>, <em>seed</em>, <em>prerank=False</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.algorithm.gsea_compute" title="Permalink to this definition">¶</a></dt>
<dd><p>compute enrichment scores and enrichment nulls.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> &#8211; prepreocessed expression dataframe or a pre-ranked file if prerank=True.</li>
<li><strong>gmt</strong> &#8211; all gene sets in .gmt file. need to call gsea_gmt_parser() to get results.</li>
<li><strong>n</strong> &#8211; permutation number. default: 1000.</li>
<li><strong>method</strong> &#8211; ranking_metric method. see above.</li>
<li><strong>phenoPos</strong> &#8211; one of lables of phenotype&#8217;s names.</li>
<li><strong>phenoNeg</strong> &#8211; one of lable of phenotype&#8217;s names.</li>
<li><strong>classes</strong> &#8211; a list of phenotype labels, to specify which column of dataframe belongs to what catogry of phenotype.</li>
<li><strong>weighted_score_type</strong> &#8211; default:1</li>
<li><strong>ascending</strong> &#8211; sorting order of rankings. Default: False.</li>
<li><strong>seed</strong> &#8211; random seed. Default: np.random.RandomState()</li>
<li><strong>prerank</strong> &#8211; if true, this function will compute using pre-ranked file passed by parameter data.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>zipped results of es, nes, pval, fdr. Used for generating reportes and plotting.</p>
<p>a nested list of hit indexs of input gene_list. Used for plotting.</p>
<p>a nested list of ranked enrichment score of each input gene_sets. Used for plotting.</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.gsea_compute_ss">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">gsea_compute_ss</code><span class="sig-paren">(</span><em>data</em>, <em>gmt</em>, <em>n</em>, <em>weighted_score_type</em>, <em>seed</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.algorithm.gsea_compute_ss" title="Permalink to this definition">¶</a></dt>
<dd><p>compute enrichment scores and enrichment nulls for single sample GSEA.</p>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.gsea_pval">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">gsea_pval</code><span class="sig-paren">(</span><em>es</em>, <em>esnull</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.algorithm.gsea_pval" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute nominal p-value.</p>
<p>From article (PNAS):
estimate nominal p-value for S from esnull by using the positive
or negative portion of the distribution corresponding to the sign 
of the observed ES(S).</p>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.gsea_significance">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">gsea_significance</code><span class="sig-paren">(</span><em>enrichment_scores</em>, <em>enrichment_nulls</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.algorithm.gsea_significance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute nominal p-vals, normalized ES, and FDR q value.</p>
<p>For a given NES(S) = NES* &gt;= 0. The FDR is the ratio of the percantage of all (S,pi) with
NES(S,pi) &gt;= 0, whose NES(S,pi) &gt;= NES*, divided by the percentage of
observed S wih NES(S) &gt;= 0, whose NES(S) &gt;= NES*, and similarly if NES(S) = NES* &lt;= 0.</p>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.normalize">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">normalize</code><span class="sig-paren">(</span><em>es</em>, <em>enrNull</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.algorithm.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>normalize the ES(S,pi) and the observed ES(S), separetely rescaling
the positive and negative scores by divident by the mean of the ES(S,pi).</p>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.preprocess">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">preprocess</code><span class="sig-paren">(</span><em>df</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.algorithm.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>pre-processed the data frame.new filtering methods will be implement here.</p>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.ranking_metric">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">ranking_metric</code><span class="sig-paren">(</span><em>df</em>, <em>method</em>, <em>phenoPos</em>, <em>phenoNeg</em>, <em>classes</em>, <em>ascending</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.algorithm.ranking_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>The main function to rank an expression table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> &#8211; gene_expression DataFrame.</li>
<li><strong>method</strong> &#8211; <p>The method used to calculate a correlation or ranking. Default: &#8216;log2_ratio_of_classes&#8217;.
Others methods are:</p>
<ol class="arabic">
<li>&#8216;signal_to_noise&#8217;<p>You must have at least three samples for each phenotype to use this metric.
The larger the signal-to-noise ratio, the larger the differences of the means (scaled by the standard deviations);
that is, the more distinct the gene expression is in each phenotype and the more the gene acts as a “class marker.”</p>
</li>
<li>&#8216;t_test&#8217;<p>Uses the difference of means scaled by the standard deviation and number of samples. 
Note: You must have at least three samples for each phenotype to use this metric.
The larger the tTest ratio, the more distinct the gene expression is in each phenotype 
and the more the gene acts as a “class marker.”</p>
</li>
<li>&#8216;ratio_of_classes&#8217; (also referred to as fold change).<p>Uses the ratio of class means to calculate fold change for natural scale data.</p>
</li>
<li>&#8216;diff_of_classes&#8217;<p>Uses the difference of class means to calculate fold change for log scale data</p>
</li>
<li>&#8216;log2_ratio_of_classes&#8217;<p>Uses the log2 ratio of class means to calculate fold change for natural scale data.
This is the recommended statistic for calculating fold change for natural scale data.</p>
</li>
</ol>
</li>
<li><strong>phenoPos</strong> &#8211; one of lables of phenotype&#8217;s names.</li>
<li><strong>phenoNeg</strong> &#8211; one of lable of phenotype&#8217;s names.</li>
<li><strong>classes</strong> &#8211; a list of phenotype labels, to specify which column of dataframe belongs to what catogry of phenotype.</li>
<li><strong>ascending</strong> &#8211; bool or list of bool. Sort ascending vs. descending.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt>returns correlation to class of each variable. same format with .rnk file. gene_name in first coloum,</dt>
<dd><p class="first last">correlation in second column.</p>
</dd>
</dl>
<p>visit here for more docs: <a class="reference external" href="http://software.broadinstitute.org/gsea/doc/GSEAUserGuideFrame.html">http://software.broadinstitute.org/gsea/doc/GSEAUserGuideFrame.html</a></p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.shuffle_list">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">shuffle_list</code><span class="sig-paren">(</span><em>gene_list</em>, <em>rand=&lt;mtrand.RandomState object&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.algorithm.shuffle_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of a shuffled input gene_list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gene_list</strong> &#8211; rank_metric[&#8216;gene_name&#8217;].values</li>
<li><strong>rand</strong> &#8211; random seed. Use random.Random(0) if you like.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a ranodm shuffled list.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-gseapy.enrichr">
<span id="enrichr"></span><h2>Enrichr<a class="headerlink" href="#module-gseapy.enrichr" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="gseapy.enrichr.enrichr">
<code class="descclassname">gseapy.enrichr.</code><code class="descname">enrichr</code><span class="sig-paren">(</span><em>gene_list</em>, <em>gene_sets</em>, <em>description='foo'</em>, <em>outdir='Enrichr'</em>, <em>cutoff=0.05</em>, <em>format='pdf'</em>, <em>figsize=(3</em>, <em>6)</em>, <em>top_term=10</em>, <em>scale=0.8</em>, <em>no_plot=False</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.enrichr.enrichr" title="Permalink to this definition">¶</a></dt>
<dd><p>Enrichr API.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gene_list</strong> &#8211; Flat file with list of genes, one gene id per row.
or a python list object</li>
<li><strong>gene_sets</strong> &#8211; Enrichr Library to query.</li>
<li><strong>description</strong> &#8211; name of analysis</li>
<li><strong>outdir</strong> &#8211; Output file directory</li>
<li><strong>cutoff</strong> &#8211; Adjust P-value cutoff, for plotting. Default: 0.05</li>
<li><strong>format</strong> &#8211; Output figure format supported by matplotlib,(&#8216;pdf&#8217;,&#8217;png&#8217;,&#8217;eps&#8217;...). Default: &#8216;pdf&#8217;.</li>
<li><strong>no_plot</strong> &#8211; Bool, if equal to True, no figure will be draw. This is useful only if data are interested. Default: False.</li>
<li><strong>verbose</strong> &#8211; Bool, increase output verbosity, print out progress of your job, Default: False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A DataFrame of enrchment results, only if call <code class="docutils literal"><span class="pre">enrichr</span></code> inside python console.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-gseapy.parser">
<span id="parser"></span><h2>Parser<a class="headerlink" href="#module-gseapy.parser" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="gseapy.parser.get_library_name">
<code class="descclassname">gseapy.parser.</code><code class="descname">get_library_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.parser.get_library_name" title="Permalink to this definition">¶</a></dt>
<dd><p>return enrichr active enrichr library name.</p>
</dd></dl>

<dl class="function">
<dt id="gseapy.parser.gsea_cls_parser">
<code class="descclassname">gseapy.parser.</code><code class="descname">gsea_cls_parser</code><span class="sig-paren">(</span><em>cls</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.parser.gsea_cls_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Extact class(phenotype) name from .cls file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cls</strong> &#8211; the a class list instance or .cls file which is identical to GSEA input .</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">phenotype name and a list of class vector.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.parser.gsea_edb_parser">
<code class="descclassname">gseapy.parser.</code><code class="descname">gsea_edb_parser</code><span class="sig-paren">(</span><em>results_path</em>, <em>index=0</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.parser.gsea_edb_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse results.edb file stored under <strong>edb</strong> file folder.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>results_path</strong> &#8211; the .results file where lcoated inside edb folder.</li>
<li><strong>index</strong> &#8211; gene_set index of gmt database, used for iterating items.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">enrichment_term, hit_index,nes, pval, fdr.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.parser.gsea_gmt_parser">
<code class="descclassname">gseapy.parser.</code><code class="descname">gsea_gmt_parser</code><span class="sig-paren">(</span><em>gmt</em>, <em>min_size=3</em>, <em>max_size=1000</em>, <em>gene_list=None</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.parser.gsea_gmt_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse gene_sets.gmt(gene set database) file or download from enrichr server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gmt</strong> &#8211; the gene_sets.gmt file of GSEA input or an enrichr libary name.
checkout full enrichr library name here: <a class="reference external" href="http://amp.pharm.mssm.edu/Enrichr/#stats">http://amp.pharm.mssm.edu/Enrichr/#stats</a></li>
<li><strong>min_size</strong> &#8211; Minimum allowed number of genes from gene set also the data set. Default: 3.</li>
<li><strong>max_size</strong> &#8211; Maximum allowed number of genes from gene set also the data set. Default: 5000.</li>
<li><strong>gene_list</strong> &#8211; Used for filtering gene set. Only used this argument for <code class="xref py py-func docutils literal"><span class="pre">call()</span></code> method.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Return a new filtered gene set database dictionary.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>DO NOT</strong> filter gene sets, when use <code class="xref py py-func docutils literal"><span class="pre">replot()</span></code>. Because <code class="docutils literal"><span class="pre">GSEA</span></code> Desktop have already
do this for you.</p>
</dd></dl>

<dl class="function">
<dt id="gseapy.parser.gsea_rank_metric">
<code class="descclassname">gseapy.parser.</code><code class="descname">gsea_rank_metric</code><span class="sig-paren">(</span><em>rnk</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.parser.gsea_rank_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse .rnk file. This file contains ranking correlation vector and gene names or ids.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rnk</strong> &#8211; the .rnk file of GSEA input or a ranked pandas DataFrame instance.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a pandas DataFrame with 3 columns names are:<p>&#8216;gene_name&#8217;,&#8217;rank&#8217;,rank2&#8217;</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-gseapy.plot">
<span id="graph"></span><h2>Graph<a class="headerlink" href="#module-gseapy.plot" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="gseapy.plot.adjust_spines">
<code class="descclassname">gseapy.plot.</code><code class="descname">adjust_spines</code><span class="sig-paren">(</span><em>ax</em>, <em>spines</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.plot.adjust_spines" title="Permalink to this definition">¶</a></dt>
<dd><p>function for removing spines and ticks.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> &#8211; axes object</li>
<li><strong>spines</strong> &#8211; a list of spines names to keep. e.g [left, right, top, bottom]
if spines = []. remove all spines and ticks.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.plot.barplot">
<code class="descclassname">gseapy.plot.</code><code class="descname">barplot</code><span class="sig-paren">(</span><em>df</em>, <em>top_term=10</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.plot.barplot" title="Permalink to this definition">¶</a></dt>
<dd><p>barplot for enrichr results</p>
</dd></dl>

<dl class="function">
<dt id="gseapy.plot.dotplot">
<code class="descclassname">gseapy.plot.</code><code class="descname">dotplot</code><span class="sig-paren">(</span><em>df</em>, <em>cutoff=0.05</em>, <em>figsize=(3.5</em>, <em>6)</em>, <em>top_term=10</em>, <em>scale=1</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.plot.dotplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize enrichr results.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> &#8211; GSEApy DataFrame results.</li>
<li><strong>cutoff</strong> &#8211; p-adjust cut-off.</li>
<li><strong>top_term</strong> &#8211; number of enriched terms to show.</li>
<li><strong>scale</strong> &#8211; dotplot point size scale.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a dotplot for enrichr terms.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.plot.gsea_plot">
<code class="descclassname">gseapy.plot.</code><code class="descname">gsea_plot</code><span class="sig-paren">(</span><em>rank_metric</em>, <em>enrich_term</em>, <em>hit_ind</em>, <em>nes</em>, <em>pval</em>, <em>fdr</em>, <em>RES</em>, <em>phenoPos=None</em>, <em>phenoNeg=None</em>, <em>figsize=(6.5</em>, <em>6)</em>, <em>**kwarg</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.plot.gsea_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the main function for reproducing the gsea plot.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rank_metric</strong> &#8211; rankings, rank_metric[&#8216;rank&#8217;].values.</li>
<li><strong>enrich_term</strong> &#8211; gene_set name</li>
<li><strong>hit_ind</strong> &#8211; hit indexs of rank_metric[&#8216;gene_name&#8217;] presented in gene set S.</li>
<li><strong>nes</strong> &#8211; Normalized enrichment scores.</li>
<li><strong>pval</strong> &#8211; nominal p-value.</li>
<li><strong>fdr</strong> &#8211; false discoveray rate.</li>
<li><strong>RES</strong> &#8211; ranking enrichment scores of all genes in rank_metric[&#8216;gene_name&#8217;].</li>
<li><strong>phenoPos</strong> &#8211; phenotype lable, positive correlated.</li>
<li><strong>phenoNeg</strong> &#8211; phenotype lable, negative correlated.</li>
<li><strong>figsize</strong> &#8211; matplotlib figsize.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">fig object of gsea plot.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.plot.heatmap">
<code class="descclassname">gseapy.plot.</code><code class="descname">heatmap</code><span class="sig-paren">(</span><em>df</em>, <em>term</em>, <em>outdir</em>, <em>axis=0</em>, <em>figsize=(5</em>, <em>5)</em>, <em>format='png'</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.plot.heatmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the dataframe.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>df</strong> &#8211; DataFrame from expression table.</li>
<li><strong>term</strong> &#8211; gene set name.</li>
<li><strong>outdir</strong> &#8211; path to save heatmap.</li>
<li><strong>axis</strong> &#8211; z_score axis.</li>
<li><strong>figsize</strong> &#8211; heatmap figsize.</li>
<li><strong>format</strong> &#8211; Matplotlib supported figure formats.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.plot.z_score">
<code class="descclassname">gseapy.plot.</code><code class="descname">z_score</code><span class="sig-paren">(</span><em>data2d</em>, <em>axis=0</em><span class="sig-paren">)</span><a class="headerlink" href="#gseapy.plot.z_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Standarize the mean and variance of the data axis Parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data2d</strong> &#8211; DataFrame to normalize.</li>
<li><strong>axis</strong> &#8211; int, Which axis to normalize across. If 0, normalize across rows, 
if 1, normalize across columns.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Normalized DataFrame. Noramlized data with a mean of 0 and variance of 1 
across the specified axis.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="gseapy_tutorial.html" class="btn btn-neutral float-right" title="A Protocol to Prepare files for GSEAPY" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="introduction.html" class="btn btn-neutral" title="Welcome to GSEAPY’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Zhuoqing Fang.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.8.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>