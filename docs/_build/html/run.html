

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>GSEAPY Running Documentation &mdash; GSEAPY 0.3.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="GSEAPY 0.3.1 documentation" href="index.html"/>
        <link rel="prev" title="GSEAPY Running Documentation" href=""/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> GSEAPY
          

          
          </a>

          
            
            
              <div class="version">
                0.3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Welcome to GSEAPY&#8217;s documentation!</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#why-gseapy">Why GSEAPY</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#features-of-gseapy">Features of GSEAPY</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#gsea-desktop-version-output">GSEA desktop version output:</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#gseapy-output">GSEAPY output</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#dependency">Dependency</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#run-gseapy">Run GSEAPY</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="">GSEAPY Running Documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#for-command-line-usage">For command line usage:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-gseapy-inside-python">Run gseapy inside python:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#to-see-help-information-of-gseapy">To See help information of GSEAPY</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-apis">Module APIs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-gseapy.algorithm">Algorithms</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">GSEAPY Running Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#for-command-line-usage">For command line usage:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-gseapy-inside-python">Run gseapy inside python:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#to-see-help-information-of-gseapy">To See help information of GSEAPY</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gseapy-subcommands">1. gseapy subcommands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-replot-command">2. The <code class="docutils literal"><span class="pre">replot</span></code> Command</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-call-command">3. The <code class="docutils literal"><span class="pre">call</span></code> Command</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-apis">Module APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-gseapy.algorithm">Algorithms</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">GSEAPY</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>GSEAPY Running Documentation</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/run.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-gseapy">
<span id="gseapy-running-documentation"></span><span id="run"></span><h1>GSEAPY Running Documentation<a class="headerlink" href="#module-gseapy" title="Permalink to this headline">¶</a></h1>
<div class="section" id="for-command-line-usage">
<h2>For command line usage:<a class="headerlink" href="#for-command-line-usage" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">replot</span></code> module reproduce GSEA desktop version results. The only input for GSEAPY is the location to GSEA results.</p>
<p>The <code class="docutils literal"><span class="pre">call</span></code> module produce GSEAPY results. The input requries a txt file( FPKM, Expected Counts, TPM, et.al), a cls file,
and gene_sets file in gmt format. The input files&#8217; formats are identical to <code class="docutils literal"><span class="pre">GSEA</span></code> desktop version.
See <a class="reference external" href="http://www.broadinstitute.org/cancer/software/gsea/wiki/index.php/Main_Page">GSEA</a> documentation for more information.</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ gseapy replot -i path/to/GSEA_resutls_folder -o gesapy_out

# An example to reproduce figures using replot module.
$ gseapy replot -i ./Gsea.reports -o test


# an example to compute using gseapy call module
$ gseapy call -d exptable.txt -c test.cls -g test.gmt
</pre></div>
</div>
</div>
<div class="section" id="run-gseapy-inside-python">
<h2>Run gseapy inside python:<a class="headerlink" href="#run-gseapy-inside-python" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">gseapy</span>
</pre></div>
</div>
<p>This will import the following:</p>
<ul class="simple">
<li>The <a class="reference internal" href="#gseapy.replot" title="gseapy.replot"><code class="xref py py-func docutils literal"><span class="pre">replot()</span></code></a> function to reproduce GSEA desktop results</li>
<li>The <a class="reference internal" href="#gseapy.run" title="gseapy.run"><code class="xref py py-func docutils literal"><span class="pre">run()</span></code></a> function to computing es,nes,pval,fdr,and generate plots <em>de nove</em>.</li>
</ul>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># An example to reproduce figures using replot module.</span>
<span class="n">gseapy</span><span class="o">.</span><span class="n">replot</span><span class="p">(</span><span class="s">&#39;./Gsea.reports&#39;</span><span class="p">,</span><span class="s">&#39;test&#39;</span><span class="p">)</span>

<span class="c"># calculate es, nes, pval,fdrs, and produce figures using gseapy.</span>
<span class="n">gseapy</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">expression</span><span class="o">.</span><span class="n">txt</span><span class="p">,</span> <span class="n">gene_sets</span> <span class="o">=</span> <span class="n">gene_sets</span><span class="o">.</span><span class="n">gmt</span><span class="p">,</span><span class="n">cls</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">cls</span><span class="p">,</span>
          <span class="n">min_size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="n">max_size</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">permutation_n</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">weighted_score_type</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
          <span class="n">permutation_type</span> <span class="o">=</span> <span class="s">&#39;gene_set&#39;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s">&#39;log2_ratio_of_classes&#39;</span><span class="p">,</span><span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
          <span class="n">outdir</span><span class="o">=</span><span class="s">&#39;test&#39;</span><span class="p">,</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">format</span> <span class="o">=</span> <span class="s">&#39;png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="to-see-help-information-of-gseapy">
<h2>To See help information of GSEAPY<a class="headerlink" href="#to-see-help-information-of-gseapy" title="Permalink to this headline">¶</a></h2>
<div class="section" id="gseapy-subcommands">
<h3>1. gseapy subcommands<a class="headerlink" href="#gseapy-subcommands" title="Permalink to this headline">¶</a></h3>
<div class="code bash highlight-python"><div class="highlight"><pre>$ gseapy --help

 usage: gseapy [-h] [--version] {call,replot} ...

 gseapy -- Gene Set Enrichment Analysis in Python

 positional arguments:
   {call,replot}
     call       Main GSEAPY Function: run GSEAPY instead of GSEA.
     replot     Reproduce GSEA desktop figures.

 optional arguments:
   -h, --help   show this help message and exit
   --version    show program&#39;s version number and exit
</pre></div>
</div>
<p>For command line options of each command, type: gseapy COMMAND -h</p>
</div>
<div class="section" id="the-replot-command">
<h3>2. The <code class="docutils literal"><span class="pre">replot</span></code> Command<a class="headerlink" href="#the-replot-command" title="Permalink to this headline">¶</a></h3>
<div class="code bash highlight-python"><div class="highlight"><pre>$ gseapy replot -h

usage: gseapy replot [-h] -i [-o] [-f] [--figsize width height] [-w]

 optional arguments:
   -h, --help            show this help message and exit

 Positional arguments:
   -i , --indir          The GSEA desktop results directroy that you want to
                         reproduce the figure
   -o , --outdir         The gseapy output directory. Default: the current
                         working directory
   -f , --format         Format of output figures, choose from {&#39;pdf&#39;, &#39;png&#39;,
                         &#39;jpeg&#39;, &#39;eps&#39;}. Default: &#39;pdf&#39;.
   --figsize width height
                         The figsize keyword argument need two parameter to
                         define. Default: [6.5, 6]
   -w , --weight         Weighted_score of rank_metric. Please use the same
                         value in GSEA. Choose from (0, 1, 1.5, 2),default: 1
</pre></div>
</div>
</div>
<div class="section" id="the-call-command">
<h3>3. The <code class="docutils literal"><span class="pre">call</span></code> Command<a class="headerlink" href="#the-call-command" title="Permalink to this headline">¶</a></h3>
<div class="code bash highlight-python"><div class="highlight"><pre>$ gseapy call -h

 usage: gseapy call [-h] -i DATA -c CLS -g GMT [-p] [-o] [-f]
                     [--figsize width height] [--min-size] [--max-size] [-n]
                     [-w] [-m] [-a]

 optional arguments:
   -h, --help            show this help message and exit

 Input files arguments:
   -d DATA, --datab DATA
                         Input gene expression Affymetrix dataset file in txt
                         format.Same with GSEA.
   -c CLS, --cls CLS     Input class vector (phenotype) file in CLS format.
                         Same with GSEA.
   -g GMT, --gmt GMT     Gene set database in GMT format. Same with GSEA.
   -p , --permu-type     Permutation type. Same with GSEA, choose from
                         {&#39;gene_set&#39;, &#39;phenotype&#39;}

 Output arguments:
   -o , --outdir         The GSEAPY output directory. Default: the current
                         working directory
   -f , --format         Format of output figures, choose from {&#39;pdf&#39;, &#39;png&#39;,
                         &#39;jpeg&#39;, &#39;eps&#39;}. Default: &#39;pdf&#39;.
   --figsize width height
                         The figsize keyword argument need two parameter to
                         define. Default: [6.5,6]

 GSEA advanced arguments:
   --min-size            Min size of input genes presented in Gene Sets.
                         Default: 15
   --max-size            Max size of input genes presented in Gene Sets.
                         Default: 1000
   -n , --permu-num      Number of random permutations. For calculating
                         esnulls. Default: 1000
   -w , --weight         Weighted_score of rank_metrics.For weighting input
                         genes. Choose from {0, 1, 1.5, 2},default: 1
   -m , --method         Methods to calculate correlations of ranking metrics.
                         Choose from {&#39;signal_to_noise&#39;, &#39;t_test&#39;,
                         &#39;ratio_of_classes&#39;,
                         &#39;diff_of_classes&#39;,&#39;log2_ratio_of_classes&#39;}. Default:
                         &#39;log2_ratio_of_classes&#39;
   -a, --ascending       Rank metric sorting order. If the -a flag was chosen,
                         then ascending equals to True. Default: False.
</pre></div>
</div>
</div>
</div>
<div class="section" id="module-apis">
<h2>Module APIs<a class="headerlink" href="#module-apis" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="gseapy.replot">
<code class="descclassname">gseapy.</code><code class="descname">replot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gseapy/gsea.html#replot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gseapy.replot" title="Permalink to this definition">¶</a></dt>
<dd><p>The main fuction to run inside python.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>indir</strong> &#8211; GSEA desktop results directory. In the sub folder, you must contain edb file foder.</li>
<li><strong>outdir</strong> &#8211; Output directory.</li>
<li><strong>weight</strong> &#8211; weighted score type. choose from {0,1,1.5,2}. Default: 1.</li>
<li><strong>figsize</strong> &#8211; matplotlib output figure figsize. Defult: [6.5,6].</li>
<li><strong>format</strong> &#8211; matplotlib output figure format. Default: &#8216;pdf&#8217;.</li>
<li><strong>min_size</strong> &#8211; min size of input genes presented in Gene Sets. Default: 3.</li>
<li><strong>max_size</strong> &#8211; max size of input genes presented in Gene Sets. Default: 5000.
you will not encourage to use min_size, or max_size argment in <a class="reference internal" href="#gseapy.replot" title="gseapy.replot"><code class="xref py py-func docutils literal"><span class="pre">replot()</span></code></a> function.
Because gmt file has already been filter.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Generate new figures with seleted figure format. Default: &#8216;pdf&#8217;.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.run">
<code class="descclassname">gseapy.</code><code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gseapy/gsea.html#run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gseapy.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run Gene Set Enrichment Analysis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> &#8211; Gene expression data table.</li>
<li><strong>gene_sets</strong> &#8211; Gene sets file. e.g. gmt files. Same input with GSEA.</li>
<li><strong>permutation_n</strong> &#8211; Number of permutations for significance computation. Default: 1000.</li>
<li><strong>permutation_type</strong> &#8211; Permutation type, &#8220;phenotype&#8221; (default) for phenotypes, &#8220;gene_set&#8221; for genes.</li>
<li><strong>min_size</strong> (<em>int</em>) &#8211; Minimum allowed number of genes from gene set also the data set. Defaut: 15.</li>
<li><strong>max_size</strong> (<em>int</em>) &#8211; Maximum allowed number of genes from gene set also the data set. Defaults: 15 and 1000.</li>
<li><strong>weighted_score_type</strong> &#8211; refer to <code class="xref py py-func docutils literal"><span class="pre">algorithm.enrichment_socre()</span></code>. Default:1.</li>
<li><strong>method</strong> &#8211; ranking metric method, refer to <a class="reference internal" href="#gseapy.algorithm.ranking_metric" title="gseapy.algorithm.ranking_metric"><code class="xref py py-func docutils literal"><span class="pre">algorithm.ranking_metric()</span></code></a>.</li>
<li><strong>ascending</strong> &#8211; sorting order of rankings. Default: False.</li>
<li><strong>outdir</strong> &#8211; results output directory.</li>
<li><strong>figsize</strong> &#8211; matplotlib figsize, accept a tuple or list, e.g. [width,height]. Default: [6.5,6].</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><div class="line-block">
<div class="line">a dictionary stored in a csv file where key is a gene set and values are:</div>
<div class="line">{ es: enrichment score, </div>
<div class="line">nes: normalized enrichment score, </div>
<div class="line">p: P-value, </div>
<div class="line">fdr: FDR, </div>
<div class="line">size: gene set size,</div>
<div class="line">matched_size: genes matched to the data, </div>
<div class="line">genes: gene names from the data set }</div>
<div class="line">and generate new <a href="#id1"><span class="problematic" id="id2">``</span></a>GSEA``plots.</div>
</div>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-gseapy.algorithm">
<span id="algorithms"></span><h2>Algorithms<a class="headerlink" href="#module-gseapy.algorithm" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="gseapy.algorithm.enrichment_score">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">enrichment_score</code><span class="sig-paren">(</span><em>gene_list</em>, <em>gene_set</em>, <em>weighted_score=1</em>, <em>correl_vector=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gseapy/algorithm.html#enrichment_score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gseapy.algorithm.enrichment_score" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the most important function of GSEAPY. It has the same algorithm with GSEA.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gene_list</strong> &#8211; The ordered gene list 
gene_name_list, rank_metric[&#8216;gene_name&#8217;]</li>
<li><strong>gene_set</strong> &#8211; gene_sets in gmt file, please used gsea_gmt_parser to get gene_set.</li>
<li><strong>weighted_score</strong> &#8211; It&#8217;s indentical to gsea&#8217;s weighted_score method. weighting by the correlation 
is a very reasonable choice that allows significant gene sets with less than perfect coherence. 
options: 0(classic),1,1.5,2. default:1. if one is interested in penalizing sets for lack of 
coherence or to discover sets with any type of nonrandom distribution of tags, a value p &lt; 1 
might be appropriate. On the other hand, if one uses sets with largenumber of genes and only 
a small subset of those is expected to be coherent, then one could consider using p &gt; 1. 
Our recommendation is to use p = 1 and use other settings only if you are very experienced 
with the method and its behavior.</li>
<li><strong>correl_vector</strong> &#8211; A vector with the correlations (e.g. signal to noise scores) corresponding to the genes in 
the gene list. Or rankings, rank_metric[&#8216;rank&#8217;].values</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>ES: Enrichment score (real number between -1 and +1)</p>
<p>hit_index: index of a gene in gene_list, if gene included in gene_set.</p>
<p>RES: Numerical vector containing the running enrichment score for all locations in the gene list .</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.gsea_compute">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">gsea_compute</code><span class="sig-paren">(</span><em>data</em>, <em>gmt</em>, <em>n</em>, <em>weighted_score_type</em>, <em>permutation_type</em>, <em>method</em>, <em>phenoPos</em>, <em>phenoNeg</em>, <em>classes</em>, <em>ascending</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gseapy/algorithm.html#gsea_compute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gseapy.algorithm.gsea_compute" title="Permalink to this definition">¶</a></dt>
<dd><p>compute enrichment scores and enrichment nulls.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> &#8211; prepreocessed expression dataframe.</li>
<li><strong>gmt</strong> &#8211; all gene sets in .gmt file. need to call gsea_gmt_parser() to get results.</li>
<li><strong>n</strong> &#8211; permutation number. default: 1000.</li>
<li><strong>method</strong> &#8211; ranking_metric method. see above.</li>
<li><strong>phenoPos</strong> &#8211; one of lables of phenotype&#8217;s names.</li>
<li><strong>phenoNeg</strong> &#8211; one of lable of phenotype&#8217;s names.</li>
<li><strong>classes</strong> &#8211; a list of phenotype labels, to specify which column of dataframe belongs to what catogry of phenotype.</li>
<li><strong>weighted_score_type</strong> &#8211; default:1</li>
<li><strong>ascending</strong> &#8211; sorting order of rankings. Default: False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>zipped results of es, nes, pval, fdr. Used for generating reportes and plotting.</p>
<p>a nested list of hit indexs of input gene_list. Used for plotting.</p>
<p>a nested list of ranked enrichment score of each input gene_sets. Used for plotting.</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.gsea_pval">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">gsea_pval</code><span class="sig-paren">(</span><em>es</em>, <em>esnull</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gseapy/algorithm.html#gsea_pval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gseapy.algorithm.gsea_pval" title="Permalink to this definition">¶</a></dt>
<dd><p>compute nominal p-value.</p>
<p>From article (PNAS):
estimate nominal p-value for S from esnull by using the positive
or negative portion of the distribution corresponding to the sign 
of the observed ES(S).</p>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.gsea_significance">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">gsea_significance</code><span class="sig-paren">(</span><em>enrichment_scores</em>, <em>enrichment_nulls</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gseapy/algorithm.html#gsea_significance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gseapy.algorithm.gsea_significance" title="Permalink to this definition">¶</a></dt>
<dd><p>Computing p-vals, normalized ES, FDRs.</p>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.preprocess">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">preprocess</code><span class="sig-paren">(</span><em>df</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gseapy/algorithm.html#preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gseapy.algorithm.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>pre-processed the data frame.new filtering methods will be implement here.</p>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.ranking_metric">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">ranking_metric</code><span class="sig-paren">(</span><em>df</em>, <em>method</em>, <em>phenoPos</em>, <em>phenoNeg</em>, <em>classes</em>, <em>ascending</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gseapy/algorithm.html#ranking_metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gseapy.algorithm.ranking_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>The main function to rank a expression table.</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param df:</th><td class="field-body"><p class="first">gene_expression DataFrame.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">param method:</th><td class="field-body"><ol class="first arabic">
<li><dl class="first docutils">
<dt>signal_to_noise </dt>
<dd><p class="first last">You must have at least three samples for each phenotype to use this metric.
The larger the signal-to-noise ratio, the larger the differences of the means (scaled by the standard deviations);
that is, the more distinct the gene expression is in each phenotype and the more the gene acts as a “class marker.”</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>t_test</dt>
<dd><p class="first last">uses the difference of means scaled by the standard deviation and number of samples. 
Note: You must have at least three samples for each phenotype to use this metric.
The larger the tTest ratio, the more distinct the gene expression is in each phenotype 
and the more the gene acts as a “class marker.”</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>ratio_of_classes (also referred to as fold change) </dt>
<dd><p class="first last">uses the ratio of class means to calculate fold change for natural scale data.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>diff_of_classes </dt>
<dd><p class="first last">uses the difference of class means to calculate fold change for log scale data</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>log2_ratio_of_classes </dt>
<dd><p class="first last">uses the log2 ratio of class means to calculate fold change for natural scale data.
This is the recommended statistic for calculating fold change for natural scale data.</p>
</dd>
</dl>
</li>
</ol>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">param phenoPos:</th><td class="field-body"><p class="first">one of lables of phenotype&#8217;s names</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">param phenoNeg:</th><td class="field-body"><p class="first">one of lable of phenotype&#8217;s names</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">param classes:</th><td class="field-body"><p class="first">a list of phenotype labels, to specify which column of dataframe belongs to what catogry of phenotype.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">param ascending:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first last">bool or list of bool. Sort ascending vs. descending.</p>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">returns correlation to class of each variable.
same format with .rnk file. gene_name in first coloum, correlation
in second column.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gseapy.algorithm.shuffle_list">
<code class="descclassname">gseapy.algorithm.</code><code class="descname">shuffle_list</code><span class="sig-paren">(</span><em>gene_list</em>, <em>rand=&lt;random.Random object at 0x0000014FD0A71558&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gseapy/algorithm.html#shuffle_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gseapy.algorithm.shuffle_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of a shuffled input gene_list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>gene_list</strong> &#8211; rank_metric[&#8216;gene_name&#8217;].values</td>
</tr>
<tr class="field-even field"><th class="field-name">Parm rand:</th><td class="field-body">random seed. Use random.Random(0) if you like.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a ranodm shuffled list.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="" class="btn btn-neutral" title="GSEAPY Running Documentation" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Zhuoqing Fang.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.3.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>